function setUpTrigger() {
  ScriptApp.newTrigger('postTrigger')
  .forSpreadsheet('1zmIYWU05rbd7frSJ19F3LyODemOA_5_F9by9poNXyV0')
  .onEdit()
  .create();
}

function deleteTriggers() {

  var triggers = ScriptApp.getProjectTriggers()
  triggers.forEach(x => ScriptApp.deleteTrigger(x))

}

function postTrigger(e) {

  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('datos')

  // Triggers only if one cell of column B changes
  if (e.range.columnStart == 2 && e.range.columnEnd == 2 && e.range.rowStart == e.range.rowEnd){
    const row = sheet.getRange(e.range.rowStart, e.range.columnStart - 1, 1,3).getValues()[0]
    var data = {
      'idOp': row[0],
      'tasa': row[1],
      'email': row[2]
    }

    var options = {
      'method': 'post',
      'payload': JSON.stringify(data),
      'contentType': 'application/json'
    }
    // TODO: change url to xepelin webhook
    UrlFetchApp.fetch('https://webhook.site/59ca89b2-a43b-47a9-8333-49fe37a40691', options);
  }
  

  
  
}